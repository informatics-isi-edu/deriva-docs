

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>deriva-acl-config &mdash; DERIVA Docs  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="deriva-annotation-config" href="deriva-annotation-config.html" />
    <link rel="prev" title="deriva.transfer.upload package" href="../api/deriva.transfer.upload.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting to know DERIVA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About DERIVA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../about.html#features">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about.html#fairness">FAIRness</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../platform.html">DERIVA Platform</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../platform.html#server-components">Server Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../platform.html#ermrest">ERMrest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform.html#hatrac">Hatrac</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform.html#ermresolve">ERMresolve</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform.html#ioboxd">IOBoxD</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../platform.html#client-libraries">Client Libraries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../platform.html#python-apis-deriva-py">Python APIs (deriva-py)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform.html#javascript-libraries-ermrestjs">Javascript Libraries (ERMrestJS)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../platform.html#client-applications">Client Applications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../platform.html#web-interface-chaise">Web Interface (Chaise)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform.html#desktop-clients-deriva-qt">Desktop clients (deriva-qt)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform.html#commandline-clients-deriva-py">Commandline Clients (deriva-py)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Using DERIVA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../users-guide/using-chaise.html">Using the Chaise Data Browser</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../users-guide/using-chaise.html#example-of-a-landing-page">Example of a landing page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../users-guide/using-chaise.html#filtering-sidebar">Filtering sidebar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../users-guide/using-chaise.html#search-results-view">Search results view</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../users-guide/using-chaise.html#record-page">Record page</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../users-guide/managing-data.html">Managing Data in DERIVA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../users-guide/managing-data.html#desktop-guis-for-authenticating-and-uploading-data-deriva-qt">Desktop GUIs for Authenticating and Uploading Data (deriva-qt)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../users-guide/managing-data.html#commandline-interface-for-interacting-with-data-deriva-py">Commandline Interface for interacting with Data (deriva-py)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../users-guide/managing-data.html#datapath-module-deriva-py"><code class="docutils literal notranslate"><span class="pre">datapath</span></code> module (deriva-py)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../users-guide/managing-catalogs.html">Managing Catalogs in DERIVA</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">deriva-py</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../README.html">DataPath</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../README.html#features">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#limitations">Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#tutorials">Tutorials</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../README.html#ermrest-model-management">ERMrest Model Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../README.html#features">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#limitations">Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../README.html#add-table-to-schema">Add Table to Schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../README.html#add-a-vocabulary-term-table">Add a Vocabulary Term Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../README.html#add-column-to-table">Add Column to Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../README.html#remove-a-column-from-a-table">Remove a Column from a Table</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../README.html#ermrestcatalog">ErmrestCatalog</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../README.html#catalog-binding">Catalog Binding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#client-credentials">Client Credentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#high-level-api-factories">High-Level API Factories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#low-level-http-methods">Low-Level HTTP Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#http-caching">HTTP Caching</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/deriva.html">deriva package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/deriva.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/deriva.config.html">deriva.config package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/deriva.core.html">deriva.core package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/deriva.transfer.html">deriva.transfer package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/deriva.html#module-deriva">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">deriva-acl-config</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-deriva-acl-config-to-configure-acls">Using deriva-acl-config to configure ACLs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#config-file-format">Config file format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-groups-stanza">The groups stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-group-list-table-stanza">The group_list_table stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-acl-definitions-stanza">The acl_definitions stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-acl-bindings-stanza">The acl_bindings stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-catalog-acls-stanza">The catalog_acls stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-schema-acls-stanza">The schema_acls stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-table-acls-stanza">The table_acls stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-column-acls-stanza">The column_acls stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-foreign-key-acls-stanza">The foreign_key_acls stanza</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#security-considerations">Security Considerations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deriva-annotation-config.html">deriva-annotation-config</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deriva-annotation-config.html#using-deriva-annotation-config-to-configure-annotations">Using deriva-annotation-config to configure annotations</a></li>
<li class="toctree-l3"><a class="reference internal" href="deriva-annotation-config.html#config-file-format">Config file format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deriva-annotation-config.html#the-known-attributes-stanza">The <code class="docutils literal notranslate"><span class="pre">known_attributes</span></code> stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-annotation-config.html#the-schema-annotations-stanza">The schema_annotations stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-annotation-config.html#the-table-annotations-stanza">The table_annotations stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-annotation-config.html#the-column-annotations-stanza">The column_annotations stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-annotation-config.html#the-foreign-key-annotations-stanza">The foreign_key_annotations stanza</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deriva-hatrac-cli.html">deriva-hatrac-cli</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deriva-hatrac-cli.html#features">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="deriva-hatrac-cli.html#common-options">Common options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#hostname">Hostname</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#authentication">Authentication</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deriva-hatrac-cli.html#namespace-operation-examples">Namespace operation examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#list">List</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#create-namespace">Create Namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#delete-namespace">Delete Namespace</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deriva-hatrac-cli.html#object-operation-examples">Object operation examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#put-an-object">Put an object</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#get-an-object">Get an object</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#delete-an-object">Delete an object</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deriva-hatrac-cli.html#acl-operation-examples">ACL operation examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#get-acls">Get ACLs</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#set-acls">Set ACLs</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#delete-acls">Delete ACLs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deriva-download-cli.html">deriva-download-cli</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deriva-download-cli.html#features">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="deriva-download-cli.html#command-line-options">Command-Line options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deriva-download-cli.html#positional-arguments">Positional arguments:</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-download-cli.html#optional-arguments">Optional arguments:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deriva-download-cli.html#configuration-file-format">Configuration file format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deriva-download-cli.html#configuration-file-element-catalog">Configuration file element: <code class="docutils literal notranslate"><span class="pre">catalog</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-download-cli.html#configuration-file-element-bag">Configuration file element: <code class="docutils literal notranslate"><span class="pre">bag</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-download-cli.html#configuration-file-element-env">Configuration file element: <code class="docutils literal notranslate"><span class="pre">env</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deriva-download-cli.html#supported-output-formats">Supported output formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="deriva-download-cli.html#output-format-details">Output format details</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deriva-download-cli.html#env"><code class="docutils literal notranslate"><span class="pre">env</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-download-cli.html#csv"><code class="docutils literal notranslate"><span class="pre">csv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-download-cli.html#json"><code class="docutils literal notranslate"><span class="pre">json</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-download-cli.html#json-stream"><code class="docutils literal notranslate"><span class="pre">json-stream</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-download-cli.html#download"><code class="docutils literal notranslate"><span class="pre">download</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-download-cli.html#fetch"><code class="docutils literal notranslate"><span class="pre">fetch</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#indices-and-tables">Indices and tables</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">DERIVA Docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">deriva-py</a> &raquo;</li>
        
      <li>deriva-acl-config</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/deriva-py/cli/deriva-acl-config.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="deriva-acl-config">
<span id="deriva-acl-config"></span><h1>deriva-acl-config<a class="headerlink" href="#deriva-acl-config" title="Permalink to this headline">¶</a></h1>
<div class="section" id="using-deriva-acl-config-to-configure-acls">
<span id="using-deriva-acl-config-to-configure-acls"></span><h2>Using deriva-acl-config to configure ACLs<a class="headerlink" href="#using-deriva-acl-config-to-configure-acls" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">deriva-acl-config</span></code> utility reads a configuration file and uses it to set ACLs for an ermrest catalog (or for a schema or table within that catalog). Usage is:</p>
<p><code class="docutils literal notranslate"><span class="pre">deriva-acl-config</span></code> [<code class="docutils literal notranslate"><span class="pre">-g</span></code>|<code class="docutils literal notranslate"><span class="pre">--groups-only</span></code>] [<code class="docutils literal notranslate"><span class="pre">-n</span></code>|<code class="docutils literal notranslate"><span class="pre">--dryrun</span></code>] [<code class="docutils literal notranslate"><span class="pre">-v</span></code>|<code class="docutils literal notranslate"><span class="pre">--verbose</span></code>] [<code class="docutils literal notranslate"><span class="pre">-s</span></code>|<code class="docutils literal notranslate"><span class="pre">--schema</span></code> schema] [<code class="docutils literal notranslate"><span class="pre">-t</span></code>|<code class="docutils literal notranslate"><span class="pre">--table</span></code> table] [<code class="docutils literal notranslate"><span class="pre">--host</span> <span class="pre">host</span></code>] [<code class="docutils literal notranslate"><span class="pre">--config-file</span></code> config_file] [<code class="docutils literal notranslate"><span class="pre">--credential-file</span></code> credential_file] catalog</p>
<p>where the required arguments are:</p>
<p><em>catalog</em>: an ermrest catalog number (e.g., 1)</p>
<p><code class="docutils literal notranslate"><span class="pre">--config_file</span></code> file: the name of a configuration file</p>
<p>Options are:</p>
<p><code class="docutils literal notranslate"><span class="pre">-credential_file</span></code> file: read credentials from the named <em>file</em> (if not specified, look for credentials maintained by <code class="docutils literal notranslate"><span class="pre">deriva-auth</span></code>)</p>
<p><code class="docutils literal notranslate"><span class="pre">--groups-only</span></code>: create and populate a group table (used for dynamic ACLs) based on the contents of the config file</p>
<p><code class="docutils literal notranslate"><span class="pre">--dryrun</span></code>: do nothing, just print out the catalog schema that would be applied</p>
<p><code class="docutils literal notranslate"><span class="pre">--verbose</span></code>: verbose, print acls and acl bindings for each object</p>
<p><code class="docutils literal notranslate"><span class="pre">--schema</span></code> schema: operate only on the named <em>schema</em>, not the whole catalog</p>
<p><code class="docutils literal notranslate"><span class="pre">--table</span></code> table: operate only on the named <em>table</em>, not the whole catalog (requires the <code class="docutils literal notranslate"><span class="pre">--schema</span></code> option)</p>
<p><code class="docutils literal notranslate"><span class="pre">--host</span></code> host: configure the server on the specified <em>host</em> (default <code class="docutils literal notranslate"><span class="pre">localhost</span></code>)</p>
</div>
<div class="section" id="config-file-format">
<span id="config-file-format"></span><h2>Config file format<a class="headerlink" href="#config-file-format" title="Permalink to this headline">¶</a></h2>
<p>The config file is a json file divided into the following stanzas:</p>
<p><code class="docutils literal notranslate"><span class="pre">groups</span></code>: defines a set of named group lists, which can be used in ACL definitions later in the config file.</p>
<p><code class="docutils literal notranslate"><span class="pre">group_list_table</span></code>: the schema and table name of a table to populate with the information from the <code class="docutils literal notranslate"><span class="pre">groups</span></code> stanza, so you can use the same named group lists in both static and dynamic ACLs and maintain them in one place. This table will typically be the last step in most dynamic ACL projections.</p>
<p><code class="docutils literal notranslate"><span class="pre">acl_definitions</span></code>: static ACL definitions (e.g., “{“write”: “consortium”, “select”: “everyone”}) that can be referred to later on in the config file (in this example, <code class="docutils literal notranslate"><span class="pre">consortium</span></code> and <code class="docutils literal notranslate"><span class="pre">everyone</span></code> are group lists defined in the <code class="docutils literal notranslate"><span class="pre">groups</span></code> stanza).</p>
<p><code class="docutils literal notranslate"><span class="pre">acl_bindings</span></code>: dynamic ACL definitions</p>
<p><code class="docutils literal notranslate"><span class="pre">catalog_acl</span></code>: the ACL for the catalog; this will be one of the ACLs defined in the <code class="docutils literal notranslate"><span class="pre">acl_definitions</span></code> stanza.</p>
<p><code class="docutils literal notranslate"><span class="pre">schema_acls</span></code>: ACLs for individual schemas. Static ACLs (from <code class="docutils literal notranslate"><span class="pre">acl_definitions</span></code>) stanza are assigned to schemas.</p>
<p><code class="docutils literal notranslate"><span class="pre">table_acls</span></code>: ACLs for individual tables. Static ACLs (from <code class="docutils literal notranslate"><span class="pre">acl_definitions</span></code>) and dynamic ACLs (from <code class="docutils literal notranslate"><span class="pre">acl_bindings</span></code>) are assigned to tabless.</p>
<p><code class="docutils literal notranslate"><span class="pre">column_acls</span></code>: ACLs for individual columns. Static ACLs (from <code class="docutils literal notranslate"><span class="pre">acl_definitions</span></code>) and dynamic ACLs (from <code class="docutils literal notranslate"><span class="pre">acl_bindings</span></code>) are assigned to columns</p>
<p><code class="docutils literal notranslate"><span class="pre">foreign_key_acls</span></code>: ACLs for foreign keys. Static ACLs (from <code class="docutils literal notranslate"><span class="pre">acl_definitions</span></code>) and dynamic ACLs (from <code class="docutils literal notranslate"><span class="pre">acl_bindings</span></code>) are assigned to foreign keys</p>
<div class="section" id="the-groups-stanza">
<span id="the-groups-stanza"></span><h3>The groups stanza<a class="headerlink" href="#the-groups-stanza" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">groups</span></code> stanza is a list of entries of the form</p>
<p>name: [values]</p>
<p>where <em>name</em> is a name that will be used to refer to a set of groups, and <em>values</em> is a list of group entries. The entries can be either the actual group IDs (from webauthn) or names of previously-defined groups. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="s2">&quot;groups&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;empty&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;public&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>    
        <span class="s2">&quot;isrd-staff&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;https://auth.globus.org/176baec4-ed26-11e5-8e88-22000ab4b42b&quot;</span><span class="p">],</span>
        <span class="s2">&quot;isrd-systems&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;https://auth.globus.org/3938e0d0-ed35-11e5-8641-22000ab4b42b&quot;</span><span class="p">],</span>
        <span class="s2">&quot;isrd-testers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;https://auth.globus.org/9d596ac6-22b9-11e6-b519-22000aef184d&quot;</span><span class="p">],</span>
    <span class="s2">&quot;isrd-all&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;isrd-staff&quot;</span><span class="p">,</span> <span class="s2">&quot;isrd-systems&quot;</span><span class="p">,</span> <span class="s2">&quot;isrd-testers&quot;</span><span class="p">]</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="the-group-list-table-stanza">
<span id="the-group-list-table-stanza"></span><h3>The group_list_table stanza<a class="headerlink" href="#the-group-list-table-stanza" title="Permalink to this headline">¶</a></h3>
<p>If you’re defining dynamic ACLs, at some point you’ll probably want a table in your catalog somewhere that maps names to lists of groups. The group_list_table stanza specifies the schema and table name of a table to create for this list of groups. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="s2">&quot;group_list_table&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;schema&quot;</span> <span class="p">:</span> <span class="s2">&quot;_acl_admin&quot;</span><span class="p">,</span> <span class="s2">&quot;table&quot;</span> <span class="p">:</span> <span class="s2">&quot;group_lists&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>This will cause the <code class="docutils literal notranslate"><span class="pre">_acl_admin.group_lists</span></code> table to be created (if it doesn’t already exist) and populated with the information specified in the <code class="docutils literal notranslate"><span class="pre">groups</span></code> stanza. The <code class="docutils literal notranslate"><span class="pre">name</span></code> column of the table will be the primary key and will contain group name, and the <code class="docutils literal notranslate"><span class="pre">groups</span></code> column will be the fully-expanded group list. The example <code class="docutils literal notranslate"><span class="pre">groups</span></code> stanza above will create this table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>     <span class="n">name</span>     <span class="o">|</span>                                                                                          <span class="n">groups</span>                                                                                          
<span class="o">--------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
 <span class="n">isrd</span><span class="o">-</span><span class="n">staff</span>   <span class="o">|</span> <span class="p">{</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">auth</span><span class="o">.</span><span class="n">globus</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="mi">176</span><span class="n">baec4</span><span class="o">-</span><span class="n">ed26</span><span class="o">-</span><span class="mf">11e5</span><span class="o">-</span><span class="mf">8e88</span><span class="o">-</span><span class="mi">22000</span><span class="n">ab4b42b</span><span class="p">}</span>
 <span class="n">isrd</span><span class="o">-</span><span class="n">testers</span> <span class="o">|</span> <span class="p">{</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">auth</span><span class="o">.</span><span class="n">globus</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="mi">9</span><span class="n">d596ac6</span><span class="o">-</span><span class="mi">22</span><span class="n">b9</span><span class="o">-</span><span class="mf">11e6</span><span class="o">-</span><span class="n">b519</span><span class="o">-</span><span class="mi">22000</span><span class="n">aef184d</span><span class="p">}</span>
 <span class="n">isrd</span><span class="o">-</span><span class="n">systems</span> <span class="o">|</span> <span class="p">{</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">auth</span><span class="o">.</span><span class="n">globus</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="mf">3938e0</span><span class="n">d0</span><span class="o">-</span><span class="n">ed35</span><span class="o">-</span><span class="mf">11e5</span><span class="o">-</span><span class="mi">8641</span><span class="o">-</span><span class="mi">22000</span><span class="n">ab4b42b</span><span class="p">}</span>
 <span class="n">isrd</span><span class="o">-</span><span class="nb">all</span>     <span class="o">|</span> <span class="p">{</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">auth</span><span class="o">.</span><span class="n">globus</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="mi">176</span><span class="n">baec4</span><span class="o">-</span><span class="n">ed26</span><span class="o">-</span><span class="mf">11e5</span><span class="o">-</span><span class="mf">8e88</span><span class="o">-</span><span class="mi">22000</span><span class="n">ab4b42b</span><span class="p">,</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">auth</span><span class="o">.</span><span class="n">globus</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="mi">9</span><span class="n">d596ac6</span><span class="o">-</span><span class="mi">22</span><span class="n">b9</span><span class="o">-</span><span class="mf">11e6</span><span class="o">-</span><span class="n">b519</span><span class="o">-</span><span class="mi">22000</span><span class="n">aef184d</span><span class="p">,</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">auth</span><span class="o">.</span><span class="n">globus</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="mf">3938e0</span><span class="n">d0</span><span class="o">-</span><span class="n">ed35</span><span class="o">-</span><span class="mf">11e5</span><span class="o">-</span><span class="mi">8641</span><span class="o">-</span><span class="mi">22000</span><span class="n">ab4b42b</span><span class="p">}</span>
 <span class="n">public</span>       <span class="o">|</span> <span class="p">{</span><span class="o">*</span><span class="p">}</span>
 <span class="n">empty</span>        <span class="o">|</span> <span class="p">{}</span>
</pre></div>
</div>
</div>
<div class="section" id="the-acl-definitions-stanza">
<span id="the-acl-definitions-stanza"></span><h3>The acl_definitions stanza<a class="headerlink" href="#the-acl-definitions-stanza" title="Permalink to this headline">¶</a></h3>
<p>This is where you define static ACLs for later use. The syntax is a list of</p>
<p>name: value</p>
<p>entries, where the <em>name</em> is a name you can refer to later, to assign these ACLs to objects, and the <em>value</em> is the ACL itself (which will probably contain references to the groups defined in the <code class="docutils literal notranslate"><span class="pre">groups</span></code> stanza). For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="s2">&quot;acl_definitions&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;unrestricted_read&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;select&quot;</span> <span class="p">:</span> <span class="s2">&quot;public&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">:</span> <span class="s2">&quot;isrd-systems&quot;</span><span class="p">,</span> <span class="s2">&quot;write&quot;</span><span class="p">:</span> <span class="s2">&quot;isrd-systems&quot;</span><span class="p">},</span>
        <span class="s2">&quot;isrd_read&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;select&quot;</span> <span class="p">:</span> <span class="s2">&quot;isrd-all&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">:</span> <span class="s2">&quot;isrd-systems&quot;</span><span class="p">,</span> <span class="s2">&quot;write&quot;</span><span class="p">:</span> <span class="s2">&quot;isrd-systems&quot;</span><span class="p">},</span>
        <span class="s2">&quot;secret&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;select&quot;</span> <span class="p">:</span> <span class="s2">&quot;empty&quot;</span><span class="p">}</span>
     <span class="p">}</span>
</pre></div>
</div>
<p>In this example, the <code class="docutils literal notranslate"><span class="pre">unrestricted_read</span></code> ACL grants read access to everyone and restricts create and write access to the <code class="docutils literal notranslate"><span class="pre">isrd-systems</span></code> group; the <code class="docutils literal notranslate"><span class="pre">isrd_read</span></code> ACL is the same,except that it grants read access only to the <code class="docutils literal notranslate"><span class="pre">isrd-all</span></code> set of groups. Note that this stanza only defines the set of permissions and who they’re associated with; by itself, it doesn’t apply these ACLs to any object in the catalog.</p>
</div>
<div class="section" id="the-acl-bindings-stanza">
<span id="the-acl-bindings-stanza"></span><h3>The acl_bindings stanza<a class="headerlink" href="#the-acl-bindings-stanza" title="Permalink to this headline">¶</a></h3>
<p>This is where you define dynamic ACLs for later use. The syntax is a list of</p>
<p>name: value</p>
<p>pairs, where the <em>name</em> is a name you can refer to later, and the <em>value</em> is a dynamic ACL. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="s2">&quot;acl_bindings&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;a_binding&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;scope_acl&quot;</span><span class="p">:</span> <span class="s2">&quot;isrd-staff&quot;</span><span class="p">,</span>
        <span class="s2">&quot;types&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;select&quot;</span><span class="p">],</span>
        <span class="s2">&quot;projection&quot;</span> <span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;outbound_col&quot;</span> <span class="p">:</span> <span class="s2">&quot;allowed_groups&quot;</span><span class="p">},</span> <span class="s2">&quot;groups&quot;</span><span class="p">],</span>
        <span class="s2">&quot;projection_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;acl&quot;</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>This defines an ACL binding called <code class="docutils literal notranslate"><span class="pre">a_binding</span></code>. The syntax of the binding itself is the same as defined in the ermrest ACL docs, with one exception: to specify an outbound foreign key, you can either use ermrest-standard <code class="docutils literal notranslate"><span class="pre">outbound</span></code> syntax and use the constraint name, or you can use <code class="docutils literal notranslate"><span class="pre">outbound_col</span></code> and specify the name of a column on which a foreign key is defined. It will also populate the <code class="docutils literal notranslate"><span class="pre">scope_acl</span></code> based on the referenced group list. For example, if you apply the binding <code class="docutils literal notranslate"><span class="pre">a_binding</span></code> to this table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>     <span class="n">Column</span>     <span class="o">|</span> <span class="n">Type</span> <span class="o">|</span> <span class="n">Modifiers</span> 
<span class="o">----------------+------+-----------</span>
 <span class="n">my_data</span>        <span class="o">|</span> <span class="n">text</span> <span class="o">|</span> 
 <span class="n">allowed_groups</span> <span class="o">|</span> <span class="n">text</span> <span class="o">|</span> <span class="ow">not</span> <span class="n">null</span>
<span class="n">Foreign</span><span class="o">-</span><span class="n">key</span> <span class="n">constraints</span><span class="p">:</span>
    <span class="s2">&quot;mytable_allowed_groups_fkey&quot;</span> <span class="n">FOREIGN</span> <span class="n">KEY</span> <span class="p">(</span><span class="n">allowed_groups</span><span class="p">)</span> <span class="n">REFERENCES</span> <span class="n">_acl_admin</span><span class="o">.</span><span class="n">group_lists</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>then the actual ermrest dynamic ACL will be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        <span class="s2">&quot;a_binding&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;scope_acl&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;https://auth.globus.org/176baec4-ed26-11e5-8e88-22000ab4b42b&quot;</span><span class="p">],</span>
            <span class="s2">&quot;types&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;select&quot;</span><span class="p">],</span>
            <span class="s2">&quot;projection&quot;</span> <span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;outbound&quot;</span> <span class="p">:</span> <span class="s2">&quot;mytable_allowed_groups_fkey&quot;</span><span class="p">},</span> <span class="s2">&quot;groups&quot;</span><span class="p">],</span>
            <span class="s2">&quot;projection_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;acl&quot;</span>
        <span class="p">}</span>
</pre></div>
</div>
<p>This can be useful if you want to apply the same dynamic ACL to mutliple tables, since each table’s foreign key will have a different name by default.</p>
</div>
<div class="section" id="the-catalog-acls-stanza">
<span id="the-catalog-acls-stanza"></span><h3>The catalog_acls stanza<a class="headerlink" href="#the-catalog-acls-stanza" title="Permalink to this headline">¶</a></h3>
<p>This is where ACLs for the catalog itself are set. (Note: there’s a bootstrapping issue for new catalogs - since this tool uses ermrest, you need to already have permission on the catalog before you can set any new permissions). For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="s2">&quot;catalog_acl&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;acl&quot;</span> <span class="p">:</span> <span class="s2">&quot;unrestricted_read&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>This applies the <code class="docutils literal notranslate"><span class="pre">unrestricted_read</span></code> ACL defined above to the catalog.</p>
</div>
<div class="section" id="the-schema-acls-stanza">
<span id="the-schema-acls-stanza"></span><h3>The schema_acls stanza<a class="headerlink" href="#the-schema-acls-stanza" title="Permalink to this headline">¶</a></h3>
<p>This is where ACLs for schemas are set. The syntax is a list of entries of the form:</p>
<p>{schema_descriptor: value, acl_descriptor: value}</p>
<p>A schema_descriptor is either:</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;schema&quot;:</span></code> <em>schema_name</em></p>
<p>or</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;schema_pattern:&quot;</span></code> <em>regular_expression</em></p>
<p>When setting permissions on a schema:</p>
<ul class="simple">
<li>if an exact <code class="docutils literal notranslate"><span class="pre">schema</span></code> match is found, the associated ACL is used (and any matching <code class="docutils literal notranslate"><span class="pre">schema_pattern</span></code> entries are ignored).</li>
<li>If no exact <code class="docutils literal notranslate"><span class="pre">schema</span></code> match is found and exactly one matching <code class="docutils literal notranslate"><span class="pre">schema_pattern</span></code> entry is found, then that ACL is used.</li>
<li>If no exact <code class="docutils literal notranslate"><span class="pre">schema</span></code> match is found and more than one matching <code class="docutils literal notranslate"><span class="pre">schema_pattern</span></code> entry is found, then an error is thrown.</li>
</ul>
<p>An acl descriptor has the form</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;acl&quot;:</span></code> <em>name_of_acl_defined_earlier</em></p>
<p>or</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;no_acl&quot;:</span> <span class="pre">true</span></code></p>
<p>If an <code class="docutils literal notranslate"><span class="pre">acl</span></code> is specified, the named static ACL is expanded and applied to the schema. If <code class="docutils literal notranslate"><span class="pre">no_acl</span></code> is specified, no ACL is applied to the schema (and as a result, it inherits whatever permissions are set by the catalog ACL).</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="s2">&quot;schema_acls&quot;</span> <span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;schema&quot;</span> <span class="p">:</span> <span class="s2">&quot;Vocabulary&quot;</span><span class="p">,</span> <span class="s2">&quot;no_acl&quot;</span> <span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;schema&quot;</span> <span class="p">:</span> <span class="s2">&quot;ISRD_Internal&quot;</span><span class="p">,</span> <span class="s2">&quot;acl&quot;</span> <span class="p">:</span> <span class="s2">&quot;isrd_read&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;schema_pattern&quot;</span> <span class="p">:</span> <span class="s2">&quot;.*&quot;</span><span class="p">,</span> <span class="s2">&quot;acl&quot;</span><span class="p">:</span> <span class="s2">&quot;secret&quot;</span><span class="p">}</span>
    <span class="p">]</span>
</pre></div>
</div>
<p>This, paired with the catalog_acl stanza above, allows anyone to read the Vocabulary schema and ISRD people to read the “ISRD_Internal”. It forbids anyone from reading any other schema in the catalog.</p>
</div>
<div class="section" id="the-table-acls-stanza">
<span id="the-table-acls-stanza"></span><h3>The table_acls stanza<a class="headerlink" href="#the-table-acls-stanza" title="Permalink to this headline">¶</a></h3>
<p>This is where ACLs for tables are set. The syntax is a list of entries of the form:
{schema_descriptor, table_descriptor, [acl_descriptor], [acl_bindings_descriptor]}
A schema descriptor has the same form as in the schema_acls stanza.</p>
<p>A table_descriptor is either:</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;table&quot;:</span></code> <em>table_name</em></p>
<p>or</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;table_pattern:&quot;</span></code> <em>regular_expression</em></p>
<p>Regular expression matching is used:</p>
<ul class="simple">
<li>If an entry with an exact <code class="docutils literal notranslate"><span class="pre">schema</span></code> and <code class="docutils literal notranslate"><span class="pre">table</span></code> match is found, the associated ACL is used (and any other matching entries are ignored).</li>
<li>Otherwise, if entry with an exact <code class="docutils literal notranslate"><span class="pre">schema</span></code> match and exactly one <code class="docutils literal notranslate"><span class="pre">table_pattern</span></code> match is found, that ACL is used.</li>
<li>Otherwise, if exactly one entry with a <code class="docutils literal notranslate"><span class="pre">schema_pattern</span></code> and <code class="docutils literal notranslate"><span class="pre">table_pattern</span></code> match is found, that ACL is used.</li>
<li>If none of the above is true, and multiple matching entries are found, then an error is thrown.</li>
</ul>
<p>An acl_descriptor is the same as defined above.</p>
<p>An <code class="docutils literal notranslate"><span class="pre">acl_bindings_descriptor</span></code> has the form:</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;acl_bindings&quot;:</span></code> [list_of_bindings]`</p>
<p>where <em>list_of_bindings</em> is a list of ACL bindings defined in the acl_bindings stanza.</p>
</div>
<div class="section" id="the-column-acls-stanza">
<span id="the-column-acls-stanza"></span><h3>The column_acls stanza<a class="headerlink" href="#the-column-acls-stanza" title="Permalink to this headline">¶</a></h3>
<p>This is where ACLs for columns are set. The syntax is a list of entries of the form:
{schema_descriptor, table_descriptor, column_descriptor, [acl_descriptor], [acl_bindings_descriptor] [invalidate_bindings_descriptor]}
The schema, table, acl, and acl_bindings descriptors have the same form as above.
The column_descriptor is either:</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;column&quot;:</span></code> <em>table_name</em></p>
<p>or</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;column_pattern:&quot;</span></code> <em>regular_expression</em></p>
<p>Regular expression matching is used:</p>
<ul class="simple">
<li>If an entry with exact <code class="docutils literal notranslate"><span class="pre">schema</span></code>, <code class="docutils literal notranslate"><span class="pre">table</span></code>, and <code class="docutils literal notranslate"><span class="pre">column</span></code> matches is found, the associated ACL is used (and any other matching entries are ignored).</li>
<li>Otherwise, if exactly one entry is found with <code class="docutils literal notranslate"><span class="pre">schema</span></code>, <code class="docutils literal notranslate"><span class="pre">table</span></code>, and <code class="docutils literal notranslate"><span class="pre">column</span></code> matches is found, that ACL is used</li>
<li>If multiple regular-expression matches are found and no exact match is found, an exception is thrown.</li>
</ul>
<p>The i<code class="docutils literal notranslate"><span class="pre">nvalidate_bindings</span></code> descriptor has the form:</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;invalidate_bindings&quot;</span></code>: [list_of_bindings]</p>
<p>where <em>list_of_bindings</em> is a list of bindng names to invalidate (i.e., ACL bindings that were defined on the column’s table but that should not be applied to the column).</p>
</div>
<div class="section" id="the-foreign-key-acls-stanza">
<span id="the-foreign-key-acls-stanza"></span><h3>The foreign_key_acls stanza<a class="headerlink" href="#the-foreign-key-acls-stanza" title="Permalink to this headline">¶</a></h3>
<p>This is where ACLs for foreign keys are set. The syntax is a list of entries of the form:</p>
<p>{schema_descriptor, table_descriptor, fkey_schema_descriptor, fkey_name_descriptor, [acl_descriptor], [acl_bindings_descriptor], [invalidate_bindings_descriptor]}</p>
<p>The schema, table, acl, acl_bindings, and invalidate_bindings descriptors have the same form as above.
The fkey_schema_descriptor is either:</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;foreign_key_schema&quot;:</span></code> foreign_key_schema_name</p>
<p>or</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;foreign_key_schema_pattern&quot;:</span></code> regular_expression</p>
<p>The fkey_name_descriptor is either:</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;foreign_key&quot;:</span></code> foreign_key_name</p>
<p>or</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;foreign_key_pattern&quot;:</span></code> regular_expression</p>
<p>These specify the foreign key schema and name. As with the column_acls stanza:</p>
<ul class="simple">
<li>If an exact match is found, it’s used</li>
<li>If no exact match is found and exactly one regular expression match is found, it’s used.</li>
<li>If no exact match is found and more than one regular expression match is found, an error is thrown.</li>
</ul>
</div>
</div>
<div class="section" id="security-considerations">
<span id="security-considerations"></span><h2>Security Considerations<a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>There’s no guarantee of the order in which changes will be applied. For example, if your current state restricts access to a table, like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="s2">&quot;table_acls&quot;</span> <span class="p">:</span> <span class="p">[</span>
       <span class="p">{</span><span class="s2">&quot;schema&quot;</span> <span class="p">:</span> <span class="s2">&quot;myschema&quot;</span><span class="p">,</span> <span class="s2">&quot;table&quot;</span> <span class="p">:</span> <span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="s2">&quot;acl&quot;</span><span class="p">:</span> <span class="s2">&quot;restricted_access&quot;</span><span class="p">}</span>
   <span class="p">]</span>
</pre></div>
</div>
<p>and you decide to change to a configuration that restricts access only to one sensitive column in that table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="s2">&quot;table_acls&quot;</span> <span class="p">:</span> <span class="p">[</span>
       <span class="p">{</span><span class="s2">&quot;schema&quot;</span> <span class="p">:</span> <span class="s2">&quot;myschema&quot;</span><span class="p">,</span> <span class="s2">&quot;table&quot;</span> <span class="p">:</span> <span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="s2">&quot;acl&quot;</span><span class="p">:</span> <span class="s2">&quot;open_access&quot;</span><span class="p">}</span>
   <span class="p">],</span>
   <span class="s2">&quot;column_acls&quot;</span> <span class="p">:</span> <span class="p">[</span>
       <span class="p">{</span><span class="s2">&quot;schema&quot;</span> <span class="p">:</span> <span class="s2">&quot;myschema&quot;</span><span class="p">,</span> <span class="s2">&quot;table&quot;</span> <span class="p">:</span> <span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="s2">&quot;column&quot;</span> <span class="p">:</span> <span class="s2">&quot;sensitive_column&quot;</span><span class="p">,</span> <span class="s2">&quot;acl&quot;</span><span class="p">:</span> <span class="s2">&quot;restricted_access&quot;</span><span class="p">}</span>
   <span class="p">]</span>
</pre></div>
</div>
<p>then it’s possible that the change to the table ACL will occur before the change to the column ACL, temporarily exposing the table and all its columns. The solution is to run <code class="docutils literal notranslate"><span class="pre">acl_config</span></code> in two passes, first adding the new restrictions and then removing the old ones.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="deriva-annotation-config.html" class="btn btn-neutral float-right" title="deriva-annotation-config" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../api/deriva.transfer.upload.html" class="btn btn-neutral" title="deriva.transfer.upload package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, USC Information Sciences Institute, Informatics Systems Research Division.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>