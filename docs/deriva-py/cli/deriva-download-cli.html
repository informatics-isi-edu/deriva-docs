

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>deriva-download-cli &mdash; DERIVA Docs 1.0.0-alpha documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="deriva-hatrac-cli" href="deriva-hatrac-cli.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> DERIVA Docs
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting to know DERIVA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About DERIVA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../about.html#features">Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../framework.html">DERIVA Framework</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../framework.html#server-components">Server Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../framework.html#ermrest">ERMrest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../framework.html#hatrac">Hatrac</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../framework.html#ermresolve">ERMresolve</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../framework.html#ioboxd">IOBoxD</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../framework.html#client-libraries">Client Libraries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../framework.html#python-apis-deriva-py">Python APIs (deriva-py)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../framework.html#javascript-libraries-ermrestjs">Javascript Libraries (ERMrestJS)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../framework.html#client-applications">Client Applications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../framework.html#web-interface-chaise">Web Interface (Chaise)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../framework.html#desktop-clients-deriva-qt">Desktop clients (deriva-qt)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../framework.html#commandline-clients-deriva-py">Commandline Clients (deriva-py)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Using DERIVA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../users-guide/using-chaise.html">Using the Chaise Data Browser</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../users-guide/using-chaise.html#example-of-a-landing-page">Example of a landing page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../users-guide/using-chaise.html#filtering-sidebar">Filtering sidebar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../users-guide/using-chaise.html#search-results-view">Search results view</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../users-guide/using-chaise.html#record-page">Record page</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../users-guide/managing-data.html">Managing Data in DERIVA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../users-guide/managing-data.html#desktop-guis-for-authenticating-and-uploading-data-deriva-qt">Desktop GUIs for Authenticating and Uploading Data (deriva-qt)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../users-guide/managing-data.html#commandline-interface-for-interacting-with-data-deriva-py">Commandline Interface for interacting with Data (deriva-py)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../users-guide/managing-data.html#datapath-module-deriva-py"><code class="docutils literal notranslate"><span class="pre">datapath</span></code> module (deriva-py)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../users-guide/managing-catalogs.html">Managing Catalogs in DERIVA</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">deriva-py</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../README.html">DataPath</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../README.html#features">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#limitations">Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#tutorials">Tutorials</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../README.html#ermrest-model-management">ERMrest Model Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../README.html#features">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#limitations">Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../README.html#add-table-to-schema">Add Table to Schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../README.html#add-a-vocabulary-term-table">Add a Vocabulary Term Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../README.html#add-column-to-table">Add Column to Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../README.html#remove-a-column-from-a-table">Remove a Column from a Table</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../README.html#ermrestcatalog">ErmrestCatalog</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../README.html#catalog-binding">Catalog Binding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#client-credentials">Client Credentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#high-level-api-factories">High-Level API Factories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#low-level-http-methods">Low-Level HTTP Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#http-caching">HTTP Caching</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/deriva.html">deriva package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/deriva.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/deriva.config.html">deriva.config package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/deriva.core.html">deriva.core package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/deriva.transfer.html">deriva.transfer package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/deriva.html#module-deriva">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deriva-acl-config.html">deriva-acl-config</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deriva-acl-config.html#using-deriva-acl-config-to-configure-acls">Using deriva-acl-config to configure ACLs</a></li>
<li class="toctree-l3"><a class="reference internal" href="deriva-acl-config.html#config-file-format">Config file format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deriva-acl-config.html#the-groups-stanza">The groups stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-acl-config.html#the-group-list-table-stanza">The group_list_table stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-acl-config.html#the-acl-definitions-stanza">The acl_definitions stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-acl-config.html#the-acl-bindings-stanza">The acl_bindings stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-acl-config.html#the-catalog-acls-stanza">The catalog_acls stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-acl-config.html#the-schema-acls-stanza">The schema_acls stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-acl-config.html#the-table-acls-stanza">The table_acls stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-acl-config.html#the-column-acls-stanza">The column_acls stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-acl-config.html#the-foreign-key-acls-stanza">The foreign_key_acls stanza</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deriva-acl-config.html#security-considerations">Security Considerations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deriva-annotation-config.html">deriva-annotation-config</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deriva-annotation-config.html#using-deriva-annotation-config-to-configure-annotations">Using deriva-annotation-config to configure annotations</a></li>
<li class="toctree-l3"><a class="reference internal" href="deriva-annotation-config.html#config-file-format">Config file format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deriva-annotation-config.html#the-known-attributes-stanza">The <code class="docutils literal notranslate"><span class="pre">known_attributes</span></code> stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-annotation-config.html#the-schema-annotations-stanza">The schema_annotations stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-annotation-config.html#the-table-annotations-stanza">The table_annotations stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-annotation-config.html#the-column-annotations-stanza">The column_annotations stanza</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-annotation-config.html#the-foreign-key-annotations-stanza">The foreign_key_annotations stanza</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deriva-hatrac-cli.html">deriva-hatrac-cli</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deriva-hatrac-cli.html#features">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="deriva-hatrac-cli.html#common-options">Common options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#hostname">Hostname</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#authentication">Authentication</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deriva-hatrac-cli.html#namespace-operation-examples">Namespace operation examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#list">List</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#create-namespace">Create Namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#delete-namespace">Delete Namespace</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deriva-hatrac-cli.html#object-operation-examples">Object operation examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#put-an-object">Put an object</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#get-an-object">Get an object</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#delete-an-object">Delete an object</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deriva-hatrac-cli.html#acl-operation-examples">ACL operation examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#get-acls">Get ACLs</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#set-acls">Set ACLs</a></li>
<li class="toctree-l4"><a class="reference internal" href="deriva-hatrac-cli.html#delete-acls">Delete ACLs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">deriva-download-cli</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#features">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-line-options">Command-Line options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#positional-arguments">Positional arguments:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#optional-arguments">Optional arguments:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-file-format">Configuration file format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuration-file-element-catalog">Configuration file element: <code class="docutils literal notranslate"><span class="pre">catalog</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-file-element-bag">Configuration file element: <code class="docutils literal notranslate"><span class="pre">bag</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-file-element-env">Configuration file element: <code class="docutils literal notranslate"><span class="pre">env</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#supported-output-formats">Supported output formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-format-details">Output format details</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#env"><code class="docutils literal notranslate"><span class="pre">env</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#csv"><code class="docutils literal notranslate"><span class="pre">csv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#json"><code class="docutils literal notranslate"><span class="pre">json</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#json-stream"><code class="docutils literal notranslate"><span class="pre">json-stream</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#download"><code class="docutils literal notranslate"><span class="pre">download</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fetch"><code class="docutils literal notranslate"><span class="pre">fetch</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#indices-and-tables">Indices and tables</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">DERIVA Docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">deriva-py</a> &raquo;</li>
        
      <li>deriva-download-cli</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/deriva-py/cli/deriva-download-cli.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="deriva-download-cli">
<span id="deriva-download-cli"></span><h1>deriva-download-cli<a class="headerlink" href="#deriva-download-cli" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">deriva-download-cli</span></code> is a command-line utility for orchestrating the bulk export of tabular data
(stored in ERMRest) and download of asset data (stored in Hatrac, or other supported HTTP-accessible object store).
It supports the transfer of data directly to local filesystems, or packaging results into the
<a class="reference external" href="https://en.wikipedia.org/wiki/BagIt"><code class="docutils literal notranslate"><span class="pre">bagit</span></code></a> container format.  The program is driven by the combined
usage of command-line arguments and a JSON-based configuration (“spec”) file, which contains the processing
directives used to orchestrate the creation of the result data set.</p>
<div class="section" id="features">
<span id="features"></span><h2>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Transfer both tabular data and file assets from Deriva catalogs.</li>
<li>Create <code class="docutils literal notranslate"><span class="pre">bag</span></code> containers, which may reference files stored in remote locations.</li>
<li>Supports an extensible processing pipeline whereby data may be run through transform functions
or other arbitrary processing before final result packaging.</li>
</ul>
</div>
<div class="section" id="command-line-options">
<span id="command-line-options"></span><h2>Command-Line options<a class="headerlink" href="#command-line-options" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">deriva</span><span class="o">-</span><span class="n">download</span><span class="o">-</span><span class="n">cli</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">version</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">quiet</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">debug</span><span class="p">]</span>
                              <span class="p">[</span><span class="o">--</span><span class="n">credential</span><span class="o">-</span><span class="n">file</span> <span class="o">&lt;</span><span class="n">file</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">catalog</span> <span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">]</span>
                              <span class="p">[</span><span class="o">--</span><span class="n">token</span> <span class="o">&lt;</span><span class="n">auth</span><span class="o">-</span><span class="n">token</span><span class="o">&gt;</span><span class="p">]</span>
                              <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">config</span> <span class="n">file</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output</span> <span class="nb">dir</span><span class="o">&gt;</span> <span class="o">...</span>

<span class="n">Deriva</span> <span class="n">Data</span> <span class="n">Download</span> <span class="n">Utility</span> <span class="o">-</span> <span class="n">CLI</span>

<span class="n">positional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span>                <span class="n">Fully</span> <span class="n">qualified</span> <span class="n">host</span> <span class="n">name</span><span class="o">.</span>
  <span class="o">&lt;</span><span class="n">config</span> <span class="n">file</span><span class="o">&gt;</span>         <span class="n">Path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">configuration</span> <span class="n">file</span><span class="o">.</span>
  <span class="o">&lt;</span><span class="n">output</span> <span class="nb">dir</span><span class="o">&gt;</span>          <span class="n">Path</span> <span class="n">to</span> <span class="n">an</span> <span class="n">output</span> <span class="n">directory</span><span class="o">.</span>
  <span class="p">[</span><span class="n">key</span><span class="o">=</span><span class="n">value</span> <span class="n">key</span><span class="o">=</span><span class="n">value</span> <span class="o">...</span><span class="p">]</span>
                        <span class="n">Variable</span> <span class="n">length</span> <span class="n">of</span> <span class="n">whitespace</span><span class="o">-</span><span class="n">delimited</span> <span class="n">key</span><span class="o">=</span><span class="n">value</span> <span class="n">pair</span>
                        <span class="n">arguments</span> <span class="n">used</span> <span class="k">for</span> <span class="n">string</span> <span class="n">interpolation</span> <span class="ow">in</span> <span class="n">specific</span>
                        <span class="n">parts</span> <span class="n">of</span> <span class="n">the</span> <span class="n">configuration</span> <span class="n">file</span><span class="o">.</span> <span class="n">For</span> <span class="n">example</span><span class="p">:</span>
                        <span class="n">key1</span><span class="o">=</span><span class="n">value1</span> <span class="n">key2</span><span class="o">=</span><span class="n">value2</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">--</span><span class="n">version</span>             <span class="n">Print</span> <span class="n">version</span> <span class="ow">and</span> <span class="n">exit</span><span class="o">.</span>
  <span class="o">--</span><span class="n">quiet</span>               <span class="n">Suppress</span> <span class="n">logging</span> <span class="n">output</span><span class="o">.</span>
  <span class="o">--</span><span class="n">debug</span>               <span class="n">Enable</span> <span class="n">debug</span> <span class="n">logging</span> <span class="n">output</span><span class="o">.</span>
  <span class="o">--</span><span class="n">credential</span><span class="o">-</span><span class="n">file</span> <span class="o">&lt;</span><span class="n">file</span><span class="o">&gt;</span>
                        <span class="n">Optional</span> <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">credential</span> <span class="n">file</span><span class="o">.</span>
  <span class="o">--</span><span class="n">catalog</span> <span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span>         <span class="n">Catalog</span> <span class="n">number</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="mi">1</span>
  <span class="o">--</span><span class="n">token</span> <span class="o">&lt;</span><span class="n">auth</span><span class="o">-</span><span class="n">token</span><span class="o">&gt;</span>  <span class="n">Authorization</span> <span class="n">bearer</span> <span class="n">token</span><span class="o">.</span>
</pre></div>
</div>
<div class="section" id="positional-arguments">
<span id="positional-arguments"></span><h3>Positional arguments:<a class="headerlink" href="#positional-arguments" title="Permalink to this headline">¶</a></h3>
<div class="section" id="host">
<span id="host"></span><h4><code class="docutils literal notranslate"><span class="pre">&lt;host&gt;</span></code><a class="headerlink" href="#host" title="Permalink to this headline">¶</a></h4>
<p>All operations are performed with respect to a specific host and most hosts will
require authentication. If the <code class="docutils literal notranslate"><span class="pre">--host</span> <span class="pre">HOSTNAME</span></code> option is not given, <code class="docutils literal notranslate"><span class="pre">localhost</span></code> will be assumed.</p>
</div>
<div class="section" id="config-file">
<span id="config-file"></span><h4><code class="docutils literal notranslate"><span class="pre">&lt;config</span> <span class="pre">file&gt;</span></code><a class="headerlink" href="#config-file" title="Permalink to this headline">¶</a></h4>
<p>A path to a configuration file is required.  The format and syntax of the file is described <a class="reference external" href="#configuration_file">below</a></p>
</div>
<div class="section" id="output-dir">
<span id="output-dir"></span><h4><code class="docutils literal notranslate"><span class="pre">&lt;output</span> <span class="pre">dir&gt;</span></code><a class="headerlink" href="#output-dir" title="Permalink to this headline">¶</a></h4>
<p>A path to a output base directory is required. This can be an absolute path or a path relative to the current working directory.</p>
</div>
</div>
<div class="section" id="optional-arguments">
<span id="optional-arguments"></span><h3>Optional arguments:<a class="headerlink" href="#optional-arguments" title="Permalink to this headline">¶</a></h3>
<div class="section" id="token">
<span id="token"></span><h4><code class="docutils literal notranslate"><span class="pre">--token</span></code><a class="headerlink" href="#token" title="Permalink to this headline">¶</a></h4>
<p>The CLI accepts an authentication token with the <code class="docutils literal notranslate"><span class="pre">--token</span> <span class="pre">TOKEN</span></code> option. If this
option is not given, it will look in the user home dir where the <code class="docutils literal notranslate"><span class="pre">DERIVA-Auth</span></code>
client would store the credentials.</p>
</div>
<div class="section" id="credential-file">
<span id="credential-file"></span><h4><code class="docutils literal notranslate"><span class="pre">--credential-file</span></code><a class="headerlink" href="#credential-file" title="Permalink to this headline">¶</a></h4>
<p>If <code class="docutils literal notranslate"><span class="pre">--token</span></code> is not specified, the program will look in the user home dir where the <code class="docutils literal notranslate"><span class="pre">DERIVA-Auth</span></code>
client would store the credentials.  Use the <code class="docutils literal notranslate"><span class="pre">--credential</span> <span class="pre">file</span></code> argument to override this behavior and specify an alternative credential file.</p>
</div>
<div class="section" id="catalog">
<span id="catalog"></span><h4><code class="docutils literal notranslate"><span class="pre">--catalog</span></code><a class="headerlink" href="#catalog" title="Permalink to this headline">¶</a></h4>
<p>The catalog number (or path specifier). Defaults to 1.
<a name="configuration_file"></a></p>
</div>
</div>
</div>
<div class="section" id="configuration-file-format">
<span id="configuration-file-format"></span><h2>Configuration file format<a class="headerlink" href="#configuration-file-format" title="Permalink to this headline">¶</a></h2>
<p>The configuration JSON file (or “spec”) is the primary mechanism for orchestrating the export and download of data for a given host.
There are three primary objects that comprise the configuration spec; the <code class="docutils literal notranslate"><span class="pre">catalog</span></code> element, the <code class="docutils literal notranslate"><span class="pre">env</span></code> element, and the <code class="docutils literal notranslate"><span class="pre">bag</span></code> element.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">catalog</span></code> object is a REQUIRED element, and is principally composed of an array named <code class="docutils literal notranslate"><span class="pre">queries</span></code> which is a set of configuration stanzas,
executed in declared order, that individually describe <em>what</em> data to retrieve, <em>how</em> the data should be processed, and <em>where</em>
the result data should be placed in the target filesystem.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">env</span></code> object is an OPTIONAL element which, if present, is expected to be a dictionary of key-value pairs that are available to use as
interpolation variables for various keywords in the <code class="docutils literal notranslate"><span class="pre">queries</span></code> section of the configuration file.  The string substitution is performed using the keyword
interpolation syntax of Python <a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#str.format"><code class="docutils literal notranslate"><span class="pre">str.format</span></code></a>.  NOTE: when specifying arbitrary
key-value pairs on the command-line, such pairs will OVERRIDE any matching keys found in the <code class="docutils literal notranslate"><span class="pre">env</span></code> element of the configuration file.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">bag</span></code> object is an OPTIONAL element which, if present, declares that the aggregate output from all configuration stanzas listed in the
<code class="docutils literal notranslate"><span class="pre">catalog:queries</span></code> array should be packaged as a <a class="reference external" href="ttps://en.wikipedia.org/wiki/BagIt"><code class="docutils literal notranslate"><span class="pre">bagit</span></code></a> formatted container.  The <code class="docutils literal notranslate"><span class="pre">bag</span></code> element contains
various optional parameters which control bag creation specifics.</p>
<p>Example configuration file:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;env&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;accession&quot;</span><span class="p">:</span> <span class="s2">&quot;XYZ123&quot;</span><span class="p">,</span>
    <span class="nt">&quot;term&quot;</span><span class="p">:</span> <span class="s2">&quot;Chip-seq&quot;</span>
  <span class="p">},</span>
  <span class="nt">&quot;bag&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;bag_name&quot;</span><span class="p">:</span> <span class="s2">&quot;test-bag&quot;</span><span class="p">,</span>
    <span class="nt">&quot;bag_archiver&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
    <span class="nt">&quot;bag_metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;Source-Organization&quot;</span><span class="p">:</span> <span class="s2">&quot;USC Information Sciences Institute, Informatics Systems Research Division&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nt">&quot;catalog&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;queries&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">&quot;query_path&quot;</span><span class="p">:</span> <span class="s2">&quot;/attribute/D:=isa:dataset/accession={accession}/E:=isa:experiment/experiment_type:=isa:experiment_type/term=RNA%20expression%20%28RNA-seq%29/$E/STRAND:=vocabulary:strandedness/$E/R:=isa:replicate/SAMPLE:=isa:biosample/SPEC:=vocabulary:species/$R/SEQ:=isa:sequencing_data/PAIRED:=vocabulary:paired_end_or_single_read/$SEQ/file_format:=vocabulary:file_format/term=FastQ/$SEQ/dataset:=D:accession,experiment:=E:RID,biosample:=SAMPLE:RID,replicate:=R:RID,bioreplicate_num:=R:bioreplicate_number,techreplicate_num:=R:technical_replicate_number,species:=SPEC:term,paired:=PAIRED:term,stranded:=STRAND:term,read:=SEQ:read,file:=SEQ:RID,filename:=SEQ:filename,url:=SEQ:url&quot;</span><span class="p">,</span>
        <span class="nt">&quot;output_path&quot;</span><span class="p">:</span> <span class="s2">&quot;{accession}/{accession}-RNA-Seq&quot;</span><span class="p">,</span>
        <span class="nt">&quot;output_format&quot;</span><span class="p">:</span> <span class="s2">&quot;csv&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&quot;query_path&quot;</span><span class="p">:</span> <span class="s2">&quot;/attribute/D:=isa:dataset/accession={accession}/E:=isa:experiment/experiment_type:=isa:experiment_type/term=RNA%20expression%20%28RNA-seq%29/$E/STRAND:=vocabulary:strandedness/$E/R:=isa:replicate/SAMPLE:=isa:biosample/SPEC:=vocabulary:species/$R/SEQ:=isa:sequencing_data/PAIRED:=vocabulary:paired_end_or_single_read/$SEQ/file_format:=vocabulary:file_format/term=FastQ/$SEQ/dataset:=D:RID,experiment:=E:RID,biosample:=SAMPLE:RID,file:=SEQ:RID,filename:=SEQ:filename,size:=SEQ:byte_count,md5:=SEQ:md5,url:=SEQ:url&quot;</span><span class="p">,</span>
        <span class="nt">&quot;output_path&quot;</span><span class="p">:</span> <span class="s2">&quot;{dataset}/{experiment}/{biosample}/seq&quot;</span><span class="p">,</span>
        <span class="nt">&quot;output_format&quot;</span><span class="p">:</span> <span class="s2">&quot;download&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&quot;query_path&quot;</span><span class="p">:</span> <span class="s2">&quot;/attribute/D:=isa:dataset/accession={accession}/E:=isa:experiment/experiment_type:=isa:experiment_type/term=Chip-seq/$E/TARGET:=vocabulary:target_of_assay/$E/R:=isa:replicate/SAMPLE:=isa:biosample/SPEC:=vocabulary:species/$R/SEQ:=isa:sequencing_data/PAIRED:=vocabulary:paired_end_or_single_read/$SEQ/file_format:=vocabulary:file_format/term=FastQ/$SEQ/dataset:=D:accession,experiment:=E:RID,control:=E:control_assay,biosample:=SAMPLE:RID,replicate:=R:RID,bioreplicate_num:=R:bioreplicate_number,technical_replicate_num:=R:technical_replicate_number,species:=SPEC:term,target:=TARGET:term,paired:=PAIRED:term,read:=SEQ:read,file:=SEQ:RID,filename:=SEQ:filename,url:=SEQ:url&quot;</span><span class="p">,</span>
        <span class="nt">&quot;output_path&quot;</span><span class="p">:</span> <span class="s2">&quot;{accession}/{accession}-ChIP-Seq&quot;</span><span class="p">,</span>
        <span class="nt">&quot;output_format&quot;</span><span class="p">:</span> <span class="s2">&quot;csv&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&quot;query_path&quot;</span><span class="p">:</span> <span class="s2">&quot;/attribute/D:=isa:dataset/accession={accession}/E:=isa:experiment/experiment_type:=isa:experiment_type/term=Chip-seq/$E/TARGET:=vocabulary:target_of_assay/$E/R:=isa:replicate/SAMPLE:=isa:biosample/SPEC:=vocabulary:species/$R/SEQ:=isa:sequencing_data/PAIRED:=vocabulary:paired_end_or_single_read/$SEQ/file_format:=vocabulary:file_format/term=FastQ/$SEQ/dataset:=D:accession,experiment:=E:RID,biosample:=SAMPLE:RID,technical_replicate_num:=R:technical_replicate_number,file:=SEQ:RID,filename:=SEQ:filename,size:=SEQ:byte_count,md5:=SEQ:md5,url:=SEQ:url&quot;</span><span class="p">,</span>
        <span class="nt">&quot;output_path&quot;</span><span class="p">:</span> <span class="s2">&quot;{dataset}/{experiment}/{biosample}/seq&quot;</span><span class="p">,</span>
        <span class="nt">&quot;output_format&quot;</span><span class="p">:</span> <span class="s2">&quot;fetch&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="configuration-file-element-catalog">
<span id="configuration-file-element-catalog"></span><h3>Configuration file element: <code class="docutils literal notranslate"><span class="pre">catalog</span></code><a class="headerlink" href="#configuration-file-element-catalog" title="Permalink to this headline">¶</a></h3>
<p>Example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;catalog&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;queries&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">&quot;query_path&quot;</span><span class="p">:</span> <span class="s2">&quot;/attribute/D:=isa:dataset/accession={accession}/E:=isa:experiment/experiment_type:=isa:experiment_type/term=Chip-seq/$E/TARGET:=vocabulary:target_of_assay/$E/R:=isa:replicate/SAMPLE:=isa:biosample/SPEC:=vocabulary:species/$R/SEQ:=isa:sequencing_data/PAIRED:=vocabulary:paired_end_or_single_read/$SEQ/file_format:=vocabulary:file_format/term=FastQ/$SEQ/dataset:=D:accession,experiment:=E:RID,control:=E:control_assay,biosample:=SAMPLE:RID,replicate:=R:RID,bioreplicate_num:=R:bioreplicate_number,technical_replicate_num:=R:technical_replicate_number,species:=SPEC:term,target:=TARGET:term,paired:=PAIRED:term,read:=SEQ:read,file:=SEQ:RID,filename:=SEQ:filename,url:=SEQ:url&quot;</span><span class="p">,</span>
        <span class="nt">&quot;output_path&quot;</span><span class="p">:</span> <span class="s2">&quot;{accession}/{accession}-ChIP-Seq&quot;</span><span class="p">,</span>
        <span class="nt">&quot;output_format&quot;</span><span class="p">:</span> <span class="s2">&quot;csv&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&quot;query_path&quot;</span><span class="p">:</span> <span class="s2">&quot;/attribute/D:=isa:dataset/accession={accession}/E:=isa:experiment/experiment_type:=isa:experiment_type/term=Chip-seq/$E/TARGET:=vocabulary:target_of_assay/$E/R:=isa:replicate/SAMPLE:=isa:biosample/SPEC:=vocabulary:species/$R/SEQ:=isa:sequencing_data/PAIRED:=vocabulary:paired_end_or_single_read/$SEQ/file_format:=vocabulary:file_format/term=FastQ/$SEQ/dataset:=D:accession,experiment:=E:RID,biosample:=SAMPLE:RID,technical_replicate_num:=R:technical_replicate_number,file:=SEQ:RID,filename:=SEQ:filename,size:=SEQ:byte_count,md5:=SEQ:md5,url:=SEQ:url&quot;</span><span class="p">,</span>
        <span class="nt">&quot;output_path&quot;</span><span class="p">:</span> <span class="s2">&quot;{dataset}/{experiment}/{biosample}/seq&quot;</span><span class="p">,</span>
        <span class="nt">&quot;output_format&quot;</span><span class="p">:</span> <span class="s2">&quot;fetch&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Parameters:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Parent Object</th>
<th>Parameter</th>
<th>Description</th>
<th>Interpolatable</th>
</tr>
</thead>
<tbody>
<tr>
<td>root</td>
<td><em>catalog</em></td>
<td>This is the parent object for all catalog related parameters.</td>
<td>No</td>
</tr>
<tr>
<td><em>catalog</em></td>
<td><em>queries</em></td>
<td>This is an array of objects representing a list of <code>ERMRest</code> queries and the logical outputs of these queries. The logical outputs of each query are then in turn processed by an <em>output format processor</em>, which can either be one of a set of default processors, or an external class conforming to a specified interface.</td>
<td>No</td>
</tr>
<tr>
<td><em>queries</em></td>
<td><em>query_path</em></td>
<td>This is string representing the actual <code>ERMRest</code> query path to be used in the HTTP(S) GET request. It SHOULD already be percent-encoded per <a href="https://tools.ietf.org/html/rfc3986#section-2.1">RFC 3986</a> if it contains any characters outside of the unreserved set.</td>
<td>Yes</td>
</tr>
<tr>
<td><em>queries</em></td>
<td><em>output_path</em></td>
<td>This is a POSIX-compliant path fragment indicating the target location of the retrieved data relative to the specified base download directory.</td>
<td>Yes</td>
</tr>
<tr>
<td><em>queries</em></td>
<td><em>output_format</em></td>
<td>This is a string value used to select from one of the built-in output processor formats. Valid values are <code>env</code>, <code>csv</code>, <code>json</code>, <code>json-stream</code>, <code>download</code>, or <code>fetch</code>.</td>
<td>No</td>
</tr>
<tr>
<td><em>queries</em></td>
<td><em>output_format_params</em></td>
<td>A JSON object of arbitrary complexity containing format-specific processing instructions that will be passed to the <code>output_format_processor</code> instance to be used. This is a context-specific parameter, i.e., this parameter MAY be required for a given <code>output_format_processor</code>, otherwise it can be omitted.</td>
<td>No</td>
</tr>
<tr>
<td><em>queries</em></td>
<td><em>output_format_processor</em></td>
<td>A fully qualified Python class name declaring an external processor class instance to use. If this parameter is present, it OVERRIDES the value (if specified) in <code>output_format</code>. This class MUST be derived from the base class <code>deriva.transfer.download.processors.BaseDownloadProcessor</code>. For example, <code>"output_processor": "deriva.transfer.download.processors.CSVDownloadProcessor"</code>.</td>
<td>No</td>
</tr>
</tbody>
</table></div>
<div class="section" id="configuration-file-element-bag">
<span id="configuration-file-element-bag"></span><h3>Configuration file element: <code class="docutils literal notranslate"><span class="pre">bag</span></code><a class="headerlink" href="#configuration-file-element-bag" title="Permalink to this headline">¶</a></h3>
<p>Example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;bag&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;bag_name&quot;</span><span class="p">:</span> <span class="s2">&quot;test-bag&quot;</span><span class="p">,</span>
        <span class="nt">&quot;bag_archiver&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
        <span class="nt">&quot;bag_algorithms&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sha256&quot;</span><span class="p">],</span>
        <span class="nt">&quot;bag_metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;Source-Organization&quot;</span><span class="p">:</span> <span class="s2">&quot;USC Information Sciences Institute, Informatics Systems Research Division&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Parameters:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Parent Object</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>root</td>
<td><em>bag</em></td>
<td>This is the parent object for all bag-related defaults.</td>
</tr>
<tr>
<td><em>bag</em></td>
<td><em>bag_algorithms</em></td>
<td>This is an array of strings representing the default checksum algorithms to use for bag manifests, if not otherwise specified.  Valid values are "md5", "sha1", "sha256", and "sha512".</td>
</tr>
<tr>
<td><em>bag</em></td>
<td><em>bag_archiver</em></td>
<td>This is a string representing the default archiving format to use if not otherwise specified.  Valid values are "zip", "tar", and "tgz".</td>
</tr>
<tr>
<td><em>bag</em></td>
<td><em>bag_metadata</em></td>
<td>This is a list of simple JSON key-value pairs that will be written as-is to bag-info.txt.</td>
</tr>
</tbody>
</table></div>
<div class="section" id="configuration-file-element-env">
<span id="configuration-file-element-env"></span><h3>Configuration file element: <code class="docutils literal notranslate"><span class="pre">env</span></code><a class="headerlink" href="#configuration-file-element-env" title="Permalink to this headline">¶</a></h3>
<p>Example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;env&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;accession&quot;</span><span class="p">:</span> <span class="s2">&quot;XYZ123&quot;</span><span class="p">,</span>
        <span class="nt">&quot;term&quot;</span><span class="p">:</span> <span class="s2">&quot;Chip-seq&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Parameters:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Parent Object</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>root</td>
<td><em>env</em></td>
<td>This is the parent object for all global "environment" variables. Note that the usage of <em>"env"</em> in this case does not refer to the set of OS environment variables, but rather a combination of key-value pairs from the JSON configuration file and CLI arguments.</td>
</tr>
<tr>
<td><em>env</em></td>
<td><em>[any, 0-N]</em></td>
<td>Any number of arguments of the form <code>key:value</code> where <code>value</code> is a <code>string</code>.</td>
</tr>
</tbody>
</table></div>
</div>
<div class="section" id="supported-output-formats">
<span id="supported-output-formats"></span><h2>Supported output formats<a class="headerlink" href="#supported-output-formats" title="Permalink to this headline">¶</a></h2>
<p>The following <code class="docutils literal notranslate"><span class="pre">output_format</span></code> tag values are supported by default:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Tag</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#env"><code>env</code></a></td>
<td>Metadata</td>
<td>Populates the context metadata ("environment") with values returned by the query.</td>
</tr>
<tr>
<td><a href="#csv"><code>csv</code></a></td>
<td>CSV</td>
<td>CSV format with column header row</td>
</tr>
<tr>
<td><a href="#json"><code>json</code></a></td>
<td>JSON</td>
<td>JSON Array of row objects.</td>
</tr>
<tr>
<td><a href="#jsons"><code>json-stream</code></a></td>
<td>"Streaming" JSON</td>
<td>Newline-delimited, multi-object JSON.</td>
</tr>
<tr>
<td><a href="#download"><code>download</code></a></td>
<td>Asset download</td>
<td>File assets referenced by URL are download to local storage relative to <code>output_path</code>.</td>
</tr>
<tr>
<td><a href="#fetch"><code>fetch</code></a></td>
<td>Asset reference</td>
<td><code>Bag</code>-based. File assets referenced by URL are assigned as remote file references via <code>fetch.txt</code>.</td>
</tr>
</tbody>
</table></div>
<div class="section" id="output-format-details">
<span id="output-format-details"></span><h2>Output format details<a class="headerlink" href="#output-format-details" title="Permalink to this headline">¶</a></h2>
<p>Each <em>output format processor</em> is designed for a specific task, and the task types may vary for a given data export task.
Some <em>output formats</em> are designed to handle the export of tabular data from the catalog, while others are meant to handle the export of file assets that are referenced by tables in the catalog.
Other <em>output formats</em> may be implemented that could perform a combination of these tasks, implement a new format, or perform some kind of data transformation.</p>
<p><a name="env"></a></p>
<div class="section" id="env">
<span id="env"></span><h3><code class="docutils literal notranslate"><span class="pre">env</span></code><a class="headerlink" href="#env" title="Permalink to this headline">¶</a></h3>
<p>This <code class="docutils literal notranslate"><span class="pre">output_format</span></code> processor performs a catalog query in JSON mode and stores the key-value pairs of the <em>first</em> row of data returned into the metadata context or “working environment” for the download.
These key-value pairs can then be used as interpolation variables in subsequent stages of processing.</p>
<p><a name="csv"></a></p>
</div>
<div class="section" id="csv">
<span id="csv"></span><h3><code class="docutils literal notranslate"><span class="pre">csv</span></code><a class="headerlink" href="#csv" title="Permalink to this headline">¶</a></h3>
<p>This <code class="docutils literal notranslate"><span class="pre">output_format</span></code> generates a standard Comma Separated Values formatted text file. The first row is a comma-delimited list of column names, and all subsequent rows are comma-delimted values.  Fields are not enclosed in quotation marks.</p>
<p>Example output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">subject_id</span><span class="p">,</span><span class="n">sample_id</span><span class="p">,</span><span class="n">snp_id</span><span class="p">,</span><span class="n">gt</span><span class="p">,</span><span class="n">chipset</span>
<span class="n">CNP0001_F09</span><span class="p">,</span><span class="mi">600009963128</span><span class="p">,</span><span class="n">rs6265</span><span class="p">,</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="n">HumanOmniExpress</span>
<span class="n">CNP0002_F15</span><span class="p">,</span><span class="mi">600018902293</span><span class="p">,</span><span class="n">rs6265</span><span class="p">,</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="n">HumanOmniExpress</span>
</pre></div>
</div>
<p><a name="json"></a></p>
</div>
<div class="section" id="json">
<span id="json"></span><h3><code class="docutils literal notranslate"><span class="pre">json</span></code><a class="headerlink" href="#json" title="Permalink to this headline">¶</a></h3>
<p>This <code class="docutils literal notranslate"><span class="pre">output_format</span></code> generates a text file containing a JSON Array of row data, where each JSON object in the array represents one row.</p>
<p>Example output:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="nt">&quot;subject_id&quot;</span><span class="p">:</span><span class="s2">&quot;CNP0001_F09&quot;</span><span class="p">,</span><span class="nt">&quot;sample_id&quot;</span><span class="p">:</span><span class="s2">&quot;600009963128&quot;</span><span class="p">,</span><span class="nt">&quot;snp_id&quot;</span><span class="p">:</span><span class="s2">&quot;rs6265&quot;</span><span class="p">,</span><span class="nt">&quot;gt&quot;</span><span class="p">:</span><span class="s2">&quot;0/1&quot;</span><span class="p">,</span><span class="nt">&quot;chipset&quot;</span><span class="p">:</span><span class="s2">&quot;HumanOmniExpress&quot;</span><span class="p">},</span>
 <span class="p">{</span><span class="nt">&quot;subject_id&quot;</span><span class="p">:</span><span class="s2">&quot;CNP0002_F15&quot;</span><span class="p">,</span><span class="nt">&quot;sample_id&quot;</span><span class="p">:</span><span class="s2">&quot;600018902293&quot;</span><span class="p">,</span><span class="nt">&quot;snp_id&quot;</span><span class="p">:</span><span class="s2">&quot;rs6265&quot;</span><span class="p">,</span><span class="nt">&quot;gt&quot;</span><span class="p">:</span><span class="s2">&quot;0/0&quot;</span><span class="p">,</span><span class="nt">&quot;chipset&quot;</span><span class="p">:</span><span class="s2">&quot;HumanOmniExpress&quot;</span><span class="p">}]</span>
</pre></div>
</div>
<p><a name="jsons"></a></p>
</div>
<div class="section" id="json-stream">
<span id="json-stream"></span><h3><code class="docutils literal notranslate"><span class="pre">json-stream</span></code><a class="headerlink" href="#json-stream" title="Permalink to this headline">¶</a></h3>
<p>This <code class="docutils literal notranslate"><span class="pre">output_format</span></code> generates a text file containing multiple lines of individual JSON objects terminated by the <em>newline</em> line terminator <code class="docutils literal notranslate"><span class="pre">\n</span></code>. This
format is generally used when the result set is too prohibitively large to parse as a single JSON object and instead can be processed on a line-by-line basis.</p>
<p>Example output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;subject_id&quot;</span><span class="p">:</span><span class="s2">&quot;CNP0001_F09&quot;</span><span class="p">,</span><span class="s2">&quot;sample_id&quot;</span><span class="p">:</span><span class="s2">&quot;600009963128&quot;</span><span class="p">,</span><span class="s2">&quot;snp_id&quot;</span><span class="p">:</span><span class="s2">&quot;rs6265&quot;</span><span class="p">,</span><span class="s2">&quot;gt&quot;</span><span class="p">:</span><span class="s2">&quot;0/1&quot;</span><span class="p">,</span><span class="s2">&quot;chipset&quot;</span><span class="p">:</span><span class="s2">&quot;HumanOmniExpress&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="s2">&quot;subject_id&quot;</span><span class="p">:</span><span class="s2">&quot;CNP0002_F15&quot;</span><span class="p">,</span><span class="s2">&quot;sample_id&quot;</span><span class="p">:</span><span class="s2">&quot;600018902293&quot;</span><span class="p">,</span><span class="s2">&quot;snp_id&quot;</span><span class="p">:</span><span class="s2">&quot;rs6265&quot;</span><span class="p">,</span><span class="s2">&quot;gt&quot;</span><span class="p">:</span><span class="s2">&quot;0/0&quot;</span><span class="p">,</span><span class="s2">&quot;chipset&quot;</span><span class="p">:</span><span class="s2">&quot;HumanOmniExpress&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p><a name="download"></a></p>
</div>
<div class="section" id="download">
<span id="download"></span><h3><code class="docutils literal notranslate"><span class="pre">download</span></code><a class="headerlink" href="#download" title="Permalink to this headline">¶</a></h3>
<p>This <code class="docutils literal notranslate"><span class="pre">output_format</span></code> processor performs multiple actions. First, it issues a <code class="docutils literal notranslate"><span class="pre">json-stream</span></code> catalog query against the specified <code class="docutils literal notranslate"><span class="pre">query_path</span></code>,
in order to generate a <em>file download manifest</em> file named <code class="docutils literal notranslate"><span class="pre">download-manifest.json</span></code>. This manifest is simply a set of rows which MUST contain at least one field named <code class="docutils literal notranslate"><span class="pre">url</span></code>, and MAY contain a field named <code class="docutils literal notranslate"><span class="pre">filename</span></code>,
and MAY contain other abritrary fields. If the <code class="docutils literal notranslate"><span class="pre">filename</span></code> field is present, it will be appended to the final (calculated) <code class="docutils literal notranslate"><span class="pre">output_path</span></code>, otherwise the application will perform a <em>HEAD</em> HTTP request against
the <code class="docutils literal notranslate"><span class="pre">url</span></code> for the <code class="docutils literal notranslate"><span class="pre">Content-Disposition</span></code> of the referenced file asset. If this query fails to determine the filename, the application falls back to using the final string component of the <code class="docutils literal notranslate"><span class="pre">url</span></code> field after the last <code class="docutils literal notranslate"><span class="pre">/</span></code> character.</p>
<p>If other fields are present, they are available for variable substitution in other parameters that support interpolation, e.g., <code class="docutils literal notranslate"><span class="pre">output_path</span></code>.</p>
<p>After the <em>file download manifest</em> is generated, the application attempts to download the files referenced in each <code class="docutils literal notranslate"><span class="pre">url</span></code> field to the local filesystem, storing them at the base relative path specified by <code class="docutils literal notranslate"><span class="pre">output_path</span></code>.</p>
<p>For example, the following configuration stanza:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;query_path&quot;</span><span class="p">:</span> <span class="s2">&quot;/attribute/D:=isa:dataset/accession={accession}/E:=isa:experiment/experiment_type:=isa:experiment_type/term=RNA%20expression%20%28RNA-seq%29/$E/STRAND:=vocabulary:strandedness/$E/R:=isa:replicate/SAMPLE:=isa:biosample/SPEC:=vocabulary:species/$R/SEQ:=isa:sequencing_data/PAIRED:=vocabulary:paired_end_or_single_read/$SEQ/file_format:=vocabulary:file_format/term=FastQ/$SEQ/dataset:=D:RID,experiment:=E:RID,biosample:=SAMPLE:RID,file:=SEQ:RID,filename:=SEQ:filename,size:=SEQ:byte_count,md5:=SEQ:md5,url:=SEQ:url&quot;</span><span class="p">,</span>
  <span class="nt">&quot;output_path&quot;</span><span class="p">:</span> <span class="s2">&quot;{dataset}/{experiment}/{biosample}/seq&quot;</span><span class="p">,</span>
  <span class="nt">&quot;output_format&quot;</span><span class="p">:</span> <span class="s2">&quot;download&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Produces a <code class="docutils literal notranslate"><span class="pre">download-manifest.json</span></code> with rows like:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;dataset&quot;</span><span class="p">:</span><span class="mi">13641</span><span class="p">,</span>
  <span class="nt">&quot;experiment&quot;</span><span class="p">:</span><span class="mi">51203</span><span class="p">,</span>
  <span class="nt">&quot;biosample&quot;</span><span class="p">:</span><span class="mi">50233</span><span class="p">,</span>
  <span class="nt">&quot;file&quot;</span><span class="p">:</span><span class="mi">55121</span><span class="p">,</span>
  <span class="nt">&quot;filename&quot;</span><span class="p">:</span><span class="s2">&quot;LPHW_111414_001A_e11.5_facebase_md_rna_R1.fastq.gz&quot;</span><span class="p">,</span>
  <span class="nt">&quot;size&quot;</span><span class="p">:</span><span class="mi">2976697043</span><span class="p">,</span>
  <span class="nt">&quot;md5&quot;</span><span class="p">:</span><span class="s2">&quot;9139b1626a35122fa85688cbb7ae6a8a&quot;</span><span class="p">,</span>
  <span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="s2">&quot;/hatrac/facebase/data/fb2/FB00000806.2/LPHW_111414_001A_e11.5_facebase_md_rna_R1.fastq.gz&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>After the <code class="docutils literal notranslate"><span class="pre">output_path</span></code> template string is interpolated with the values of the example row above, the file is then downloaded to the following relative path:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="mi">13641</span><span class="o">/</span><span class="mi">51203</span><span class="o">/</span><span class="mi">50233</span><span class="o">/</span><span class="n">seq</span><span class="o">/</span><span class="n">LPHW_111414_001A_e11</span><span class="o">.</span><span class="mi">5</span><span class="n">_facebase_md_rna_R1</span><span class="o">.</span><span class="n">fastq</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<p><a name="fetch"></a></p>
</div>
<div class="section" id="fetch">
<span id="fetch"></span><h3><code class="docutils literal notranslate"><span class="pre">fetch</span></code><a class="headerlink" href="#fetch" title="Permalink to this headline">¶</a></h3>
<p>This <code class="docutils literal notranslate"><span class="pre">output_format</span></code> processor performs multiple actions. First, it issues a <code class="docutils literal notranslate"><span class="pre">json-stream</span></code> catalog query against the specified <code class="docutils literal notranslate"><span class="pre">query_path</span></code>, in order to generate a  <em>file download manifest</em>.
This manifest is simply a set of rows which MUST contain at least one field named <code class="docutils literal notranslate"><span class="pre">url</span></code>, and SHOULD contain two additional fields: <code class="docutils literal notranslate"><span class="pre">length</span></code>,
which is the size of the referenced file in bytes, and (at least) one of the following <em>checksum</em> fields; <code class="docutils literal notranslate"><span class="pre">md5</span></code>, <code class="docutils literal notranslate"><span class="pre">sha1</span></code>, <code class="docutils literal notranslate"><span class="pre">sha256</span></code>, <code class="docutils literal notranslate"><span class="pre">sha512</span></code>. If the <em>length</em> and appropriate <em>checksum</em> fields are missing,
an attempt will be made to dynamically determine these fields from the remote <code class="docutils literal notranslate"><span class="pre">url</span></code> by issuing a <em>HEAD</em> HTTP request and parsing the result headers for the missing information.
If the required values cannot be determined this way, it is an error condition and the transfer will abort.</p>
<p>Similar to the <code class="docutils literal notranslate"><span class="pre">download</span></code> processor, the output of the catalog query MAY contain other fields. If the <code class="docutils literal notranslate"><span class="pre">filename</span></code> field is present, it will be appended to the final (calculated) <code class="docutils literal notranslate"><span class="pre">output_path</span></code>, otherwise the application will perform a <em>HEAD</em> HTTP request against
the <code class="docutils literal notranslate"><span class="pre">url</span></code> for the <code class="docutils literal notranslate"><span class="pre">Content-Disposition</span></code> of the referenced file asset. If this query fails to determine the filename, the application falls back to using the final name component of the <code class="docutils literal notranslate"><span class="pre">url</span></code> field after the last <code class="docutils literal notranslate"><span class="pre">/</span></code> character.
If other fields are present, they are also available for variable substitution in other parameters that support interpolation, e.g., <code class="docutils literal notranslate"><span class="pre">output_path</span></code>.</p>
<p>Unlike the <code class="docutils literal notranslate"><span class="pre">download</span></code> processor, the <code class="docutils literal notranslate"><span class="pre">fetch</span></code> processor does not actually download any asset files, but rather uses the query results to create a <code class="docutils literal notranslate"><span class="pre">bag</span></code> with checksummed manifest entries that reference each remote asset via the <code class="docutils literal notranslate"><span class="pre">bag</span></code>’s <code class="docutils literal notranslate"><span class="pre">fetch.txt</span></code> file.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="deriva-hatrac-cli.html" class="btn btn-neutral" title="deriva-hatrac-cli" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, USC Information Sciences Institute, Informatics Systems Research Division.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0-alpha',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>